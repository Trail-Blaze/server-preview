<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="tailwind.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap"
      rel="stylesheet"
    />
  </head>
  <style>
    .skeleton {
       color: #eee;
       background: #eee;
       text-align: center;
       border-radius: 4px;
       text-transform: uppercase;
       height: auto;
       line-height: 30px;
       margin-bottom: 0.75rem;
       font-weight: 600;
       letter-spacing: 0.1rem;
    }
    .motd{
      font-family: 'Special Elite', cursive;
      /* font-family: 'Kdam Thmor Pro', sans-serif; */
      font-weight: 400;
    }
  </style>

  <body>
    <div id="container">
       <!-- START OF PLACEHOLDER CONTENT-->
      <div>
         <!-- templateIcon, ip, templateTitle, templateDescription, connectionID -->
         <div class="card-div w-full">
           <div
             onclick="changeBanner()"
             class="bg-white hover:bg-gray-100 cursor-pointer rounded-tl-xl sm:rounded-t-xl p-4 pb-6 sm:p-8 lg:p-4 lg:pb-6 xl:p-8 space-y-6 sm:space-y-8 lg:space-y-6 xl:space-y-8"
           >
             <div
               class="flex items-center space-x-3.5 sm:space-x-5 lg:space-x-3.5 xl:space-x-5"
             >
               <img
                 id="templateIcon"
                 src="src/assets/png/fortnite_lettermark_logo.png"
                 alt=""
                 width="160"
                 height="160"
                 class="flex-none w-20 h-20 rounded-lg bg-gray-100"
               />
               <div class="min-w-0 flex-auto space-y-0.5">
                 <p
                   id="entry"
                   class="text-lime-600 dark:text-lime-400 text-sm sm:text-base lg:text-sm xl:text-base font-semibold uppercase"
                 >
                   SERVER
                 </p>
                 <h2 id="templateTitle" class="skeleton">
                   APPLICATION_TEMPLATE
                 </h2>
                 <p
                   class="skeleton inline text-xs"
                   style="color: rgb(161 161 170);"
                   id="ip"
                 ></p>
                 <p
                   class="text-gray-500 dark:text-gray-400 text-base sm:text-lg lg:text-base xl:text-lg font-medium"
                 >
                   <b class="block skeleton motd" id="templateDescription"
                     >TEMPLATE_DESCRIPTION</b
                   >
                 </p>
                 <button
                   id="connectionID"
                   onclick="sendID(this.id)"
                   class="rounded border-black pr-5 pl-5 pt-2 pb-2 bg-yellow-300 font-semibold hover:opacity-70"
                 >
                   Connect
                 </button>
               </div>
             </div>
           </div>
 
           <div
             class="bg-white lg:rounded-b-xl py-4 px-1 mb-5 sm:px-3 lg:px-1 xl:px-3"
           ></div>
         </div>
       </div>
       <div>
         <!-- templateIcon, ip, templateTitle, templateDescription, connectionID -->
         <div class="card-div w-full">
           <div
             onclick="changeBanner()"
             class="bg-white hover:bg-gray-100 cursor-pointer rounded-tl-xl sm:rounded-t-xl p-4 pb-6 sm:p-8 lg:p-4 lg:pb-6 xl:p-8 space-y-6 sm:space-y-8 lg:space-y-6 xl:space-y-8"
           >
             <div
               class="flex items-center space-x-3.5 sm:space-x-5 lg:space-x-3.5 xl:space-x-5"
             >
               <img
                 id="templateIcon"
                 src="src/assets/png/fortnite_lettermark_logo.png"
                 alt=""
                 width="160"
                 height="160"
                 class="flex-none w-20 h-20 rounded-lg bg-gray-100"
               />
               <div class="min-w-0 flex-auto space-y-0.5">
                 <p
                   id="entry"
                   class="text-lime-600 dark:text-lime-400 text-sm sm:text-base lg:text-sm xl:text-base font-semibold uppercase"
                 >
                   SERVER
                 </p>
                 <h2 id="templateTitle" class="skeleton">
                   APPLICATION_TEMPLATE
                 </h2>
                 <p
                   class="skeleton inline text-xs"
                   style="color: rgb(161 161 170);"
                   id="ip"
                 ></p>
                 <p
                   class="text-gray-500 dark:text-gray-400 text-base sm:text-lg lg:text-base xl:text-lg font-medium"
                 >
                   <b class="block skeleton motd" id="templateDescription"
                     >TEMPLATE_DESCRIPTION</b
                   >
                 </p>
                 <button
                   id="connectionID"
                   onclick="sendID(this.id)"
                   class="rounded border-black pr-5 pl-5 pt-2 pb-2 bg-yellow-300 font-semibold hover:opacity-70"
                 >
                   Connect
                 </button>
               </div>
             </div>
           </div>
 
           <div
             class="bg-white lg:rounded-b-xl py-4 px-1 mb-5 sm:px-3 lg:px-1 xl:px-3"
           ></div>
         </div>
       </div>
       <div>
         <!-- templateIcon, ip, templateTitle, templateDescription, connectionID -->
         <div class="card-div w-full">
           <div
             onclick="changeBanner()"
             class="bg-white hover:bg-gray-100 cursor-pointer rounded-tl-xl sm:rounded-t-xl p-4 pb-6 sm:p-8 lg:p-4 lg:pb-6 xl:p-8 space-y-6 sm:space-y-8 lg:space-y-6 xl:space-y-8"
           >
             <div
               class="flex items-center space-x-3.5 sm:space-x-5 lg:space-x-3.5 xl:space-x-5"
             >
               <img
                 id="templateIcon"
                 src="src/assets/png/fortnite_lettermark_logo.png"
                 alt=""
                 width="160"
                 height="160"
                 class="flex-none w-20 h-20 rounded-lg bg-gray-100"
               />
               <div class="min-w-0 flex-auto space-y-0.5">
                 <p
                   id="entry"
                   class="text-lime-600 dark:text-lime-400 text-sm sm:text-base lg:text-sm xl:text-base font-semibold uppercase"
                 >
                   SERVER
                 </p>
                 <h2 id="templateTitle" class="skeleton">
                   APPLICATION_TEMPLATE
                 </h2>
                 <p
                   class="skeleton inline text-xs"
                   style="color: rgb(161 161 170);"
                   id="ip"
                 ></p>
                 <p
                   class="text-gray-500 dark:text-gray-400 text-base sm:text-lg lg:text-base xl:text-lg font-medium"
                 >
                   <b class="block skeleton motd" id="templateDescription"
                     >TEMPLATE_DESCRIPTION</b
                   >
                 </p>
                 <button
                   id="connectionID"
                   onclick="sendID(this.id)"
                   class="rounded border-black pr-5 pl-5 pt-2 pb-2 bg-yellow-300 font-semibold hover:opacity-70"
                 >
                   Connect
                 </button>
               </div>
             </div>
           </div>
 
           <div
             class="bg-white lg:rounded-b-xl py-4 px-1 mb-5 sm:px-3 lg:px-1 xl:px-3"
           ></div>
         </div>
       </div>
       <div>
         <!-- templateIcon, ip, templateTitle, templateDescription, connectionID -->
         <div class="card-div w-full">
           <div
             onclick="changeBanner()"
             class="bg-white hover:bg-gray-100 cursor-pointer rounded-tl-xl sm:rounded-t-xl p-4 pb-6 sm:p-8 lg:p-4 lg:pb-6 xl:p-8 space-y-6 sm:space-y-8 lg:space-y-6 xl:space-y-8"
           >
             <div
               class="flex items-center space-x-3.5 sm:space-x-5 lg:space-x-3.5 xl:space-x-5"
             >
               <img
                 id="templateIcon"
                 src="src/assets/png/fortnite_lettermark_logo.png"
                 alt=""
                 width="160"
                 height="160"
                 class="flex-none w-20 h-20 rounded-lg bg-gray-100"
               />
               <div class="min-w-0 flex-auto space-y-0.5">
                 <p
                   id="entry"
                   class="text-lime-600 dark:text-lime-400 text-sm sm:text-base lg:text-sm xl:text-base font-semibold uppercase"
                 >
                   SERVER
                 </p>
                 <h2 id="templateTitle" class="skeleton">
                   APPLICATION_TEMPLATE
                 </h2>
                 <p
                   class="skeleton inline text-xs"
                   style="color: rgb(161 161 170);"
                   id="ip"
                 ></p>
                 <p
                   class="text-gray-500 dark:text-gray-400 text-base sm:text-lg lg:text-base xl:text-lg font-medium"
                 >
                   <b class="block skeleton motd" id="templateDescription"
                     >TEMPLATE_DESCRIPTION</b
                   >
                 </p>
                 <button
                   id="connectionID"
                   onclick="sendID(this.id)"
                   class="rounded border-black pr-5 pl-5 pt-2 pb-2 bg-yellow-300 font-semibold hover:opacity-70"
                 >
                   Connect
                 </button>
               </div>
             </div>
           </div>
 
           <div
             class="bg-white lg:rounded-b-xl py-4 px-1 mb-5 sm:px-3 lg:px-1 xl:px-3"
           ></div>
         </div>
       </div>
       <div>
         <!-- templateIcon, ip, templateTitle, templateDescription, connectionID -->
         <div class="card-div w-full">
           <div
             onclick="changeBanner()"
             class="bg-white hover:bg-gray-100 cursor-pointer rounded-tl-xl sm:rounded-t-xl p-4 pb-6 sm:p-8 lg:p-4 lg:pb-6 xl:p-8 space-y-6 sm:space-y-8 lg:space-y-6 xl:space-y-8"
           >
             <div
               class="flex items-center space-x-3.5 sm:space-x-5 lg:space-x-3.5 xl:space-x-5"
             >
               <img
                 id="templateIcon"
                 src="src/assets/png/fortnite_lettermark_logo.png"
                 alt=""
                 width="160"
                 height="160"
                 class="flex-none w-20 h-20 rounded-lg bg-gray-100"
               />
               <div class="min-w-0 flex-auto space-y-0.5">
                 <p
                   id="entry"
                   class="text-lime-600 dark:text-lime-400 text-sm sm:text-base lg:text-sm xl:text-base font-semibold uppercase"
                 >
                   SERVER
                 </p>
                 <h2 id="templateTitle" class="skeleton">
                   APPLICATION_TEMPLATE
                 </h2>
                 <p
                   class="skeleton inline text-xs"
                   style="color: rgb(161 161 170);"
                   id="ip"
                 ></p>
                 <p
                   class="text-gray-500 dark:text-gray-400 text-base sm:text-lg lg:text-base xl:text-lg font-medium"
                 >
                   <b class="block skeleton motd" id="templateDescription"
                     >TEMPLATE_DESCRIPTION</b
                   >
                 </p>
                 <button
                   id="connectionID"
                   onclick="sendID(this.id)"
                   class="rounded border-black pr-5 pl-5 pt-2 pb-2 bg-yellow-300 font-semibold hover:opacity-70"
                 >
                   Connect
                 </button>
               </div>
             </div>
           </div>
 
           <div
             class="bg-white lg:rounded-b-xl py-4 px-1 mb-5 sm:px-3 lg:px-1 xl:px-3"
           ></div>
         </div>
       </div>
       <!-- END PLACEHOLDER CONTENT-->
    </div>
    <script>
      let _data;
      fetch(
        "https://raw.githubusercontent.com/Trail-Blaze/cdn/main/launcher/servers.json"
      )
        .then((response) => response.json())
        .then(async (data) => {
          _data = await data;
        });

      function changeID(oldid, newID) {
        e = document.getElementById(oldid.toString());
        e.id = newID;
      }

      function removeID(oldid) {
        e = document.getElementById(oldid.toString());
        e.id = "";
      }

      function sendID(clicked_id) {
        console.log(clicked_id);
        ipc.send("sendState", clicked_id);
        ipc.send("reqPageSwitch", "package_viewer.html");
      }
      ref = (id) => document.getElementById(id);

      function sleep(ms = parseInt(ms)) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }
      function getRandomInt(min, max) {
        min = Math.ceil(min);
        max = Math.floor(max);
        return Math.floor(Math.random() * (max - min) + min); //The maximum is exclusive and the minimum is inclusive
      }
    </script>

    <script id="entryTemplate" class="hidden" type="text/html">
      <!-- templateIcon, ip, templateTitle, templateDescription, connectionID -->
      <div class="card-div w-full">
        <div
          onclick="changeBanner()"
          class="bg-white hover:bg-gray-100 cursor-pointer rounded-tl-xl sm:rounded-t-xl p-4 pb-6 sm:p-8 lg:p-4 lg:pb-6 xl:p-8 space-y-6 sm:space-y-8 lg:space-y-6 xl:space-y-8"
        >
          <div
            class="flex items-center space-x-3.5 sm:space-x-5 lg:space-x-3.5 xl:space-x-5"
          >
            <img
              id="templateIcon"
              src="src/assets/png/fortnite_lettermark_logo.png"
              alt=""
              width="160"
              height="160"
              class="flex-none w-20 h-20 rounded-lg bg-gray-100"
            />
            <div class="min-w-0 flex-auto space-y-0.5">
              <p
                id="entry"
                class="text-lime-600 dark:text-lime-400 text-sm sm:text-base lg:text-sm xl:text-base font-semibold uppercase"
              >
                SERVER
              </p>
              <h2 id="templateTitle" class="skeleton">APPLICATION_TEMPLATE</h2>
              <p
                class="skeleton inline text-xs"
                style="color: rgb(161 161 170);"
                id="ip"
              ></p>
              <p
                class="text-gray-500 dark:text-gray-400 text-base sm:text-lg lg:text-base xl:text-lg font-medium"
              >
                <b class="block skeleton motd" id="templateDescription"
                  >TEMPLATE_DESCRIPTION</b
                >
              </p>
              <button
                id="connectionID"
                onclick="sendID(this.id)"
                class="rounded border-black pr-5 pl-5 pt-2 pb-2 bg-yellow-300 font-semibold hover:opacity-70"
              >
                Connect
              </button>
            </div>
          </div>
        </div>

        <div
          class="bg-white lg:rounded-b-xl py-4 px-1 mb-5 sm:px-3 lg:px-1 xl:px-3"
        ></div>
      </div>
    </script>
    <script>
      let icon;
      let ip;
      let title;
      let description;
      let CID;
      let _index;
      setTimeout(() => {
        configure();
      }, 2000);
      function configure() {
        ref("container").innerHTML = "";
        // templateIcon, ip, templateTitle, templateDescription, connectionID
        Object.keys(_data).forEach(async (value, index = index - 1) => {
          let x = document.createElement("div");
          x.innerHTML = ref("entryTemplate").innerHTML;
          ref("container").append(x);
          // Wait for write to finish
          await sleep(500);
          changeID("templateTitle", `serverT_${index}`);
          title = ref(`serverT_${index}`);
          changeID("templateIcon", `serverI_${index}`);
          icon = ref(`serverI_${index}`);
          changeID("ip", `serverip_${index}`);
          ip = ref(`serverip_${index}`);
          changeID("templateDescription", `serverD_${index}`);
          description = ref(`serverD_${index}`);
          changeID("connectionID", `${index}`);
          CID = ref(index);
          _index = index;
          tryAgain(_index, description);
        });
      }
      function tryAgain(index, desc) {
        try {
          title.innerHTML = _data[index].name;
          title.classList.value =
            "text-black dark:text-white text-base sm:text-xl lg:text-base xl:text-xl font-semibold truncate";
          icon.src = _data[index].icon;
          ip.innerHTML = _data[index].host;
          ip.classList.remove("skeleton");
          setInterval(() => {
            desc.classList.remove("skeleton");
            switch (desc.innerHTML) {
              case _data[index].motd1:
                desc.innerHTML = _data[index].motd2;
                break;
              default:
                desc.innerHTML = _data[index].motd1;
                break;
            }
          }, parseInt(getRandomInt(3, 5).toString() + "000"));
        } catch (error) {
          console.error(error);
          setTimeout(() => {
            configure();
          }, 2000);
        }
      }
    </script>
  </body>
</html>
